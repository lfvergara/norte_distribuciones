<!--DATA TABLE-->
<link href="{url_static}vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
<link href="{url_static}vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
<!--DATA TABLE-->
<div class="col-lg-12">
    <ul class="breadcrumb hidden-print">
        <li><a href="{url_app}/reporte/{panel_general}"><i class="fa fa-home"></i> HOME</a></li>
        <li class="remover-breadcrumb-stock"><a href="{url_app}/stock/panel">INVENTARIO</a></li>
    </ul>
</div>
<div class="col-md-12 col-sm-12 col-xs-12">
    <h4 style="margin-left: 0; margin-top: 0px;">Control de Rentabilidad: Desde el {desde} hasta el {hasta}</h4>
</div>
<div class="col-md-3 col-sm-12 col-xs-12">
    <div class="x_panel hidden-print" style="padding-left: 0px; padding-right: 0px; margin-bottom: 2%;">
        <div class="x_title" style="padding-left: 2%;">
            <h2><i class="fa fa-bar-chart"></i>&nbsp;&nbsp; Resúmen Facturación</h2>
            <ul class="nav navbar-right panel_toolbox hidden-print">
                <li><a class="collapse-link hidden-print"><i class="fa fa-chevron-up"></i></a></li>
                <li><a class="close-link hidden-print"><i class="fa fa-close"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <table class="table table-striped table-bordered" style="margin-bottom: 0px;">
                <thead>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-up green"></i> Venta</th>
                        <th class="green">${ventas}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Notas de Crédito</th>
                        <th class="red">${notacredito}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-up green"></i> Facturación</th>
                        <th class="green">${facturacion}</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="x_panel hidden-print" style="padding-left: 0px; padding-right: 0px; margin-bottom: 2%;">
        <div class="x_title" style="padding-left: 2%;">
            <h2><i class="fa fa-bar-chart"></i>&nbsp;&nbsp; Resúmen Ganancia Facturación</h2>
            <ul class="nav navbar-right panel_toolbox hidden-print">
                <li><a class="collapse-link hidden-print"><i class="fa fa-chevron-up"></i></a></li>
                <li><a class="close-link hidden-print"><i class="fa fa-close"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <table class="table table-striped table-bordered" style="margin-bottom: 0px;">
                <thead>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-up green"></i> Ganancia</th>
                        <th class="green">${ganancia}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Ganancia Notas de Crédito</th>
                        <th class="red">${ganancia_notacredito}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-dot-circle-o blue"></i> Ganancia Final</th>
                        <th class="blue">${ganancia_real}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-dot-circle-o blue"></i> Porcentaje Ganancia</th>
                        <th class="blue">{porcentaje_ganancia}%</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="x_panel hidden-print" style="padding-left: 0px; padding-right: 0px; margin-bottom: 2%;">
        <div class="x_title" style="padding-left: 2%;">
            <h2><i class="fa fa-bar-chart"></i>&nbsp;&nbsp; Resúmen Egresos</h2>
            <ul class="nav navbar-right panel_toolbox hidden-print">
                <li><a class="collapse-link hidden-print"><i class="fa fa-chevron-up"></i></a></li>
                <li><a class="close-link hidden-print"><i class="fa fa-close"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <table class="table table-striped table-bordered" style="margin-bottom: 0px;">
                <thead>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Salarios</th>
                        <th class="red">${salario}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Comisiones abonadas</th>
                        <th class="red">${comision}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Gastos</th>
                        <th class="red">${gastos}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-arrow-circle-down red"></i> Combustible</th>
                        <th class="red">${combustible}</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="x_panel hidden-print" style="padding-left: 0px; padding-right: 0px; margin-bottom: 2%;">
        <div class="x_title" style="padding-left: 2%;">
            <h2><i class="fa fa-bar-chart"></i>&nbsp;&nbsp; Rentabilidad</h2>
            <ul class="nav navbar-right panel_toolbox hidden-print">
                <li><a class="collapse-link hidden-print"><i class="fa fa-chevron-up"></i></a></li>
                <li><a class="close-link hidden-print"><i class="fa fa-close"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <table class="table table-striped table-bordered" style="margin-bottom: 0px;">
                <thead>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-dot-circle-o blue"></i> Rentabilidad</th>
                        <th class="blue">${rentabilidad}</th>
                    </tr>
                    <tr style="font-size: 12px;">
                        <th><i class="fa fa-dot-circle-o blue"></i> Porcentaje Rentabilidad</th>
                        <th class="blue">{porcentaje_rentabilidad}%</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>        
</div>    
<div class="col-md-5 col-sm-12 col-xs-12">
    <div class="x_panel">
        <div class="x_title">
            <h2><i class="fa fa-table"></i>&nbsp;&nbsp; Ventas del mes</h2>
            <ul class="nav navbar-right panel_toolbox">
                <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
                <li><a class="close-link"><i class="fa fa-close"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <table id="tbl_egreso" class="table table-striped table-bordered">
                <thead>
                    <tr style="font-size: 12px;">
                        <th>#</th>
                        <th>Factura</th>
                        <th>Cliente</th>
                        <th>Vendedor</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {tbl_egreso}
                </tbody>
            </table>
        </div>
    </div>
</div>

    
    
    
<!-- Datatables -->
<script src="{url_static}vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="{url_static}vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="{url_static}vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="{url_static}vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
<script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
        $('#tbl_egreso').dataTable( {
            "aaSorting": [[ 0, "asc" ]]
          , "iDisplayLength":5
        } );
    } );

    $(document).ready(function() {
        $('#tbl_producto').dataTable( {
            "aaSorting": [[ 0, "asc" ]]
          , "iDisplayLength":3
        } );
    } );

    $(document).ready(function() {
        $('#tbl_marca').dataTable( {
            "aaSorting": [[ 0, "asc" ]]
          , "iDisplayLength":3
        } );
    } );
</script>
<!-- Chart.js -->
<script src="{url_static}vendors/Chart.js/dist/Chart.min.js"></script>
<script type="text/javascript" charset="utf-8">
    var user_level = {display-user_level};
    $( window ).on( "load", function() {
        switch(user_level){
            case 1:
                $(".remover-breadcrumb-stock").css("display","none");
                break;
        }
    });

    if ($('#charPagoComisiones').length ){
        var ctx = document.getElementById("charPagoComisiones");
        var data = {
            labels: [{lbl_piechart_pago_comision}],
            datasets: [{
                data: [{valores_piechart_pago_comision}],
                backgroundColor: [
                    "#5E4EAE","#EFCB57","#F28C8F","#061E53",
                    "#D14164","#5CB9D0","#DC5242","#499187",
                    "#AD58B9","#798D8E","#FFC602","#0580BB",
                    "#E74C3C","#96281B","#C8F7C5","#455C73",
                    "#E87E04","#68C3A3","#9B59B6","#715548"

                ],
                hoverBackgroundColor: [
                    "#3B23B3","#B39534","#C75053","#020E29",
                    "#AB173B","#447582","#B72818","#2f615A",
                    "#772184","#626C6D","#CCA008","#08618C",
                    "#C63B2D","#821C12","#ACECA8","#34495E",
                    "#F48401","#4CA486","#B370CF","#442F26"
                ]
            }]
        };

        var charGastos = new Chart(ctx, {
            type: 'doughnut',
            tooltipFillColor: "rgba(51, 51, 51, 0.55)",
            data: data
        });
    }
</script>
<!-- morris.js -->
<script src="{url_static}vendors/raphael/raphael.min.js"></script>
<script src="{url_static}vendors/morris.js/morris.min.js"></script>
<script>
    if ($('#graphActivos').length ){
        Morris.Bar({
            element: 'graphActivos',
            data: [{x: 'Activos Corrientes', y: {deuda_ccclientes_graph}, z: {stock_valorizado_graph}, a: {carga_pendiente_graph}}],
            xkey: 'x',
            ykeys: ['y', 'z','a'],
            barColors: ['#26B99A', '#34495E', '#3498DB'],
            hideHover: 'auto',
            labels: ['CC Clientes', 'Stock Valorizado', 'Cargas Pendientes'],
            resize: true
        }).on('click', function (i, row) {
            console.log(i, row);
        });
    }

    if ($('#graphPasivos').length ){
        Morris.Bar({
            element: 'graphPasivos',
            data: [
                {x: 'Pasivos Corrientes', y: {deuda_ccproveedores_graph}, z: {deuda_comisiones_graph}},
            ],
            xkey: 'x',
            ykeys: ['y', 'z', 'a'],
            barColors: ['#26B99A', '#34495E', '#ACADAC', '#3498DB'],
            hideHover: 'auto',
            labels: ['Deuda Proveedores', 'Deuda Comisiones'],
            resize: true
        }).on('click', function (i, row) {
            console.log(i, row);
        });
    }

    if ($('#graphActivosPrint').length ){
        Morris.Bar({
            element: 'graphActivosPrint',
            data: [{x: 'Activos Corrientes', y: {deuda_ccclientes_graph}, z: {stock_valorizado_graph}, a: {carga_pendiente_graph}}],
            xkey: 'x',
            ykeys: ['y', 'z', 'a'],
            barColors: ['#26B99A', '#34495E', '#ACADAC', '#3498DB'],
            hideHover: 'auto',
            labels: ['CC Clientes', 'Stock Valorizado', 'Cargas Pendientes'],
            resize: true
        }).on('click', function (i, row) {
            console.log(i, row);
        });
    }

    if ($('#graphPasivosPrint').length ){
        Morris.Bar({
            element: 'graphPasivosPrint',
            data: [
                {x: 'Pasivos Corrientes', y: {deuda_ccproveedores_graph}, z: {deuda_comisiones_graph}},
            ],
            xkey: 'x',
            ykeys: ['y', 'z'],
            barColors: ['#26B99A', '#34495E', '#ACADAC', '#3498DB'],
            hideHover: 'auto',
            labels: ['Deuda Proveedores', 'Deuda Comisiones'],
            resize: true
        }).on('click', function (i, row) {
            console.log(i, row);
        });
    }
</script>
<script>
function mostrarReporteProducto() {
    document.getElementById('panel_reporte_producto').style.display = 'block';
    document.getElementById('panel_reporte_marca').style.display = 'none';
}

function mostrarReporteMarca() {
    document.getElementById('panel_reporte_producto').style.display = 'none';
    document.getElementById('panel_reporte_marca').style.display = 'block';
}

array_ids = new Array();
array_marca_ids = new Array();

function cargarProductoReporte(producto_id) {
    var flag = array_ids.indexOf(producto_id);
    var codigo = document.getElementById('tbl_cod_' + producto_id).innerHTML;
    var descripcion = document.getElementById('tbl_den_' + producto_id).innerHTML;

    if(parseInt(flag) === -1){
        var bodyTblProducto = document.getElementById('bodyTblProducto');

        /* FILA */
        var trTblProducto = document.createElement("tr");
        trTblProducto.setAttribute("id", "idTrTbl_" + producto_id);

        var tdTblBtnQuitar = document.createElement("td");
        var tdTblCodigo = document.createElement("td");
        var tdTblDescripcion = document.createElement("td");

        var btnQuitar = document.createElement("a");
        btnQuitar.setAttribute("href", "#");
        btnQuitar.setAttribute("id", "btnQuitar_" + producto_id);
        btnQuitar.setAttribute("class", "btn btn-danger btn-xs");
        btnQuitar.setAttribute("onClick", "quitarProducto(" + producto_id + ");");
        var iconQuitar = document.createElement("i");
        iconQuitar.setAttribute("class", "fa fa-trash-o");
        btnQuitar.appendChild(iconQuitar);

        var txtCodigo = document.createTextNode(codigo);
        var txtDescripcion = document.createTextNode(descripcion);
        tdTblCodigo.appendChild(txtCodigo);
        tdTblDescripcion.appendChild(txtDescripcion);
        tdTblBtnQuitar.appendChild(btnQuitar);

        trTblProducto.appendChild(tdTblCodigo);
        trTblProducto.appendChild(tdTblDescripcion);
        trTblProducto.appendChild(tdTblBtnQuitar);

        bodyTblProducto.appendChild(trTblProducto);

        /* ARRAY */
        var div_array_reporte_producto_vendedor_fecha = document.getElementById('div_array_reporte_producto_vendedor_fecha');
        var inputProductoId = document.createElement("input");
        inputProductoId.setAttribute("type", "hidden");
        inputProductoId.setAttribute("name", "producto_id[]");
        inputProductoId.setAttribute("id", "producto_id_" + producto_id);
        inputProductoId.setAttribute("value", producto_id);
        div_array_reporte_producto_vendedor_fecha.appendChild(inputProductoId);
        array_ids.push(producto_id);
    } else {
        return false;
    }
}

function quitarProducto(producto_id) {
    var bodyTblProducto = document.getElementById('bodyTblProducto');
    var trTblProducto = document.getElementById("idTrTbl_" + producto_id);

    var div_array_reporte_producto_vendedor_fecha = document.getElementById('div_array_reporte_producto_vendedor_fecha');
    var input_producto_id = document.getElementById('producto_id_' + producto_id);

    bodyTblProducto.removeChild(trTblProducto);
    div_array_reporte_producto_vendedor_fecha.removeChild(input_producto_id);
    var index = array_ids.indexOf(producto_id);
    array_ids.splice(index, 1);
}

function cargarMarcaReporte(marca_id) {
    var flag = array_marca_ids.indexOf(marca_id);
    var descripcion = document.getElementById('tbl_denmar_' + marca_id).innerHTML;

    if(parseInt(flag) === -1){
        var bodyTblMarca = document.getElementById('bodyTblMarca');

        /* FILA */
        var trTblMarca = document.createElement("tr");
        trTblMarca.setAttribute("id", "idTrTblMarca_" + marca_id);

        var tdTblBtnQuitar = document.createElement("td");
        var tdTblDescripcion = document.createElement("td");

        var btnQuitar = document.createElement("a");
        btnQuitar.setAttribute("href", "#");
        btnQuitar.setAttribute("id", "btnQuitarMarca_" + marca_id);
        btnQuitar.setAttribute("class", "btn btn-danger btn-xs");
        btnQuitar.setAttribute("onClick", "quitarMarca(" + marca_id + ");");
        var iconQuitar = document.createElement("i");
        iconQuitar.setAttribute("class", "fa fa-trash-o");
        btnQuitar.appendChild(iconQuitar);

        var txtDescripcion = document.createTextNode(descripcion);
        tdTblDescripcion.appendChild(txtDescripcion);
        tdTblBtnQuitar.appendChild(btnQuitar);

        trTblMarca.appendChild(tdTblDescripcion);
        trTblMarca.appendChild(tdTblBtnQuitar);

        bodyTblMarca.appendChild(trTblMarca);

        /* ARRAY */
        var div_array_reporte_marca_vendedor_fecha = document.getElementById('div_array_reporte_marca_vendedor_fecha');
        var inputMarcaId = document.createElement("input");
        inputMarcaId.setAttribute("type", "hidden");
        inputMarcaId.setAttribute("name", "marca_id[]");
        inputMarcaId.setAttribute("id", "marca_id_" + marca_id);
        inputMarcaId.setAttribute("value", marca_id);
        div_array_reporte_marca_vendedor_fecha.appendChild(inputMarcaId);
        array_marca_ids.push(marca_id);
    } else {
        return false;
    }
}

function quitarMarca(marca_id) {
    var bodyTblMarca = document.getElementById('bodyTblMarca');
    var trTblMarca = document.getElementById("idTrTblMarca_" + marca_id);

    var div_array_reporte_marca_vendedor_fecha = document.getElementById('div_array_reporte_marca_vendedor_fecha');
    var input_marca_id = document.getElementById('marca_id_' + marca_id);

    bodyTblMarca.removeChild(trTblMarca);
    div_array_reporte_marca_vendedor_fecha.removeChild(input_marca_id);
    var index = array_marca_ids.indexOf(marca_id);
    array_marca_ids.splice(index, 1);
}
</script>